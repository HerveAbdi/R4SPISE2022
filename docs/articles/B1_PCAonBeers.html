<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="R4SPISE2022">
<title>PCA on Beers • R4SPISE2022</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PCA on Beers">
<meta property="og:description" content="R4SPISE2022">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">R4SPISE2022</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A1_DataBeers.html">A Sensory Data Set on Beers</a>
    <a class="dropdown-item" href="../articles/A2_DataChewingGums.html">A Sensory Data Set on Chewing-gums</a>
    <a class="dropdown-item" href="../articles/A3_DataWines.html">A Sensory Data Set on Wines of The World</a>
    <a class="dropdown-item" href="../articles/B1_PCAonBeers.html">PCA on Beers</a>
    <a class="dropdown-item" href="../articles/B2_PCAonChewingGums.html">PCA on Chewing-gums</a>
    <a class="dropdown-item" href="../articles/C1_PLSConWines.html">PLSC on Wines</a>
    <a class="dropdown-item" href="../articles/C2_CCAonWines.html">Canonical Correlation Analysis on Wines</a>
    <a class="dropdown-item" href="../articles/C3_RAonWines.html">Redundancy Analysis on Wines</a>
    <a class="dropdown-item" href="../articles/C4_PLSRonWines_part1.html">PLSR on Wines (Part 1)</a>
    <a class="dropdown-item" href="../articles/C5_PLSRonWines_part2.html">PLSR on Wines (Part 2)</a>
    <a class="dropdown-item" href="../articles/R4SPISEE2022.html">Introduction to the SPISE 2022 Advanced Workshop</a>
    <a class="dropdown-item" href="../articles/other/other.html">Additionnal references</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/HerveAbdi/R4SPISE2022/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>PCA on Beers</h1>
                        <h4 data-toc-skip class="author">Vincent
Guillemot, Hervé Abdi, Ju-Chi Yu &amp; Soudeh Ardestani Khoubrouy</h4>
            
      
      <small class="dont-index">Source: <a href="http://github.com/HerveAbdi/R4SPISE2022/blob/HEAD/vignettes/B1_PCAonBeers.Rmd" class="external-link"><code>vignettes/B1_PCAonBeers.Rmd</code></a></small>
      <div class="d-none name"><code>B1_PCAonBeers.Rmd</code></div>
    </div>

    
    
<style type="text/css">
body {
  font-size: 14pt;
}
</style>
<div class="section level2">
<h2 id="load-the-data-and-the-packages">Load the data and the packages<a class="anchor" aria-label="anchor" href="#load-the-data-and-the-packages"></a>
</h2>
<p>With the following command</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/HerveAbdi/R4SPISE2022" class="external-link">R4SPISE2022</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sixBeers12Descriptors10Judges"</span>, package <span class="op">=</span> <span class="st">"data4PCCAR"</span><span class="op">)</span></span>
<span><span class="va">beers</span> <span class="op">&lt;-</span> <span class="va">sixBeers12Descriptors10Judges</span><span class="op">$</span><span class="va">ratingsIntensity</span></span>
<span><span class="va">beerColors</span> <span class="op">&lt;-</span> <span class="va">sixBeers12Descriptors10Judges</span><span class="op">$</span><span class="va">color4Products</span></span>
<span><span class="va">descColors</span> <span class="op">&lt;-</span> <span class="va">sixBeers12Descriptors10Judges</span><span class="op">$</span><span class="va">color4Descriptors</span></span></code></pre></div>
<ul>
<li>
<code>beers</code>: the ratings;</li>
<li>
<code>beerColors</code>: colors for the beers;</li>
<li>
<code>descColors</code>: colors for the descriptors.</li>
</ul>
<p>More information on the dataset is available on the corresponding
vignette: <code><a href="../articles/A1_DataBeers.html">vignette("A1_DataBeers")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="do-the-principal-component-analysis-pca">Do the Principal Component Analysis (PCA)<a class="anchor" aria-label="anchor" href="#do-the-principal-component-analysis-pca"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.pca</span> <span class="op">&lt;-</span> <span class="fu">epPCA</span><span class="op">(</span><span class="va">beers</span>, </span>
<span>                 center <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Center the data</span></span>
<span>                 scale <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># **Do not** scale the variables</span></span>
<span>                 graphs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<p>The default of this function will center (to have means equal 0) and
scale (to have the <em>standard deviations</em> equal 1) all
variables.</p>
</div>
<div class="section level2">
<h2 id="plot-the-results">Plot the results<a class="anchor" aria-label="anchor" href="#plot-the-results"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plot.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph4epPCA.html">OTAplot</a></span><span class="op">(</span></span>
<span>    resPCA <span class="op">=</span> <span class="va">res.pca</span>,</span>
<span>    data <span class="op">=</span> <span class="va">beers</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>results.stats</code>: useful statistics after performing PCA,
among which one can find the factor scores, loadings, eigenvalues, and
contributions;</li>
<li>
<code>results.graphs</code>: all the PCA graphs (heatmaps,
screeplot, factor map, correlation circles, loading maps etc.)</li>
<li>
<code>description.graphs</code>: the titles of these graphs, used as
titles in the PPTX file.</li>
</ul>
<div class="section level3">
<h3 id="correlations-of-the-variables">Correlations of the variables<a class="anchor" aria-label="anchor" href="#correlations-of-the-variables"></a>
</h3>
<p>We can check the data by plotting the correlation matrix between the
variables. This correlation matrix is where the components are
extracted.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plot.pca</span><span class="op">$</span><span class="va">results.graphs</span><span class="op">$</span><span class="va">correlation</span></span></code></pre></div>
<p><img src="B1_PCAonBeers_files/figure-html/heatmat%20cor-1.svg" width="672"></p>
</div>
<div class="section level3">
<h3 id="scree-plot">Scree plot<a class="anchor" aria-label="anchor" href="#scree-plot"></a>
</h3>
<p>The scree plot shows the eigenvalues of each component. These
eigenvalues give the <em>variance</em> of each component (or called
dimension in the figure). In other words, the singular values, which are
the square root of the eigenvalues, give the <em>standard
deviations</em> of these components. The sum of the eigenvalues is equal
to the total inertia of the data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plot.pca</span><span class="op">$</span><span class="va">results.graphs</span><span class="op">$</span><span class="va">scree</span></span></code></pre></div>
<p><img src="B1_PCAonBeers_files/figure-html/scree-1.svg" width="672"></p>
<p>According to an elbow test, there are 4 dimensions in this data.</p>
</div>
<div class="section level3">
<h3 id="factor-scores-rows">Factor scores (rows)<a class="anchor" aria-label="anchor" href="#factor-scores-rows"></a>
</h3>
<p>Here, the observation map shows how the observations (i.e., rows) are
represented in the component space. If <code>center = TRUE</code> when
running PCA, the origin should be at the center of all observations. (If
it’s not, something is off.)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plot.pca</span><span class="op">$</span><span class="va">results.graphs</span><span class="op">$</span><span class="va">factorScoresI12</span></span></code></pre></div>
<p><img src="B1_PCAonBeers_files/figure-html/factor%20scores-1.svg" width="672"></p>
<p>The result in this plot showed that the first dimension separates
<code>BlueMoon</code> from <code>Hofbrau</code>, and the second
dimension separates <code>BlueMoon</code> and <code>Hofbrau</code> from
<code>FranzDunkel</code> and <code>FranzNatur</code>.</p>
</div>
<div class="section level3">
<h3 id="circle-of-correlation">Circle of correlation<a class="anchor" aria-label="anchor" href="#circle-of-correlation"></a>
</h3>
<p>The circle of correlations illustrate how the variables are
correlated with each other and with the dimensions. From this figure,
the length of an arrow indicates how much this variable is explained by
the two given dimensions. The cosine between any two arrows gives their
correlation. The cosine between a variable and an axis gives the
correlation between that variable and the corresponding dimension.</p>
<p>In this figure, an angle closer to 0° indicates a correlation close
to 1; an angle closer to 180° indicates a correlation close to -1; and
an 90° angle indicates 0 correlation. However, it’s worth noted that
this implication of correlation might only be true within the given
dimensions. When a variable is far away from the circle, it is not fully
explained by the dimensions, and other dimensions might be characterized
by other pattern of relationship between this and other variables.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plot.pca</span><span class="op">$</span><span class="va">results.graphs</span><span class="op">$</span><span class="va">cosineCircleArrowJ12</span></span></code></pre></div>
<p><img src="B1_PCAonBeers_files/figure-html/correlation%20circle-1.svg" width="672"></p>
<p>This circle of correlation plot illustrates that Dimension 1 is
<code>Sweet</code> and <code>Alcoholic</code> versus <code>Yeast</code>,
<code>Hay</code>, <code>Bitter</code>, <code>Cereal</code>, and
<code>Toasted</code>; Dimension 2 is <code>Acid</code> and
<code>Fermented</code> versus <code>Cereal</code> and
<code>Toasted</code>. Interestingly, <code>Acid</code> and
<code>Fermented</code> are orthogonal to <code>Sweet</code> and
<code>Hay</code> (which are anti-correlated from each other) on the
first two dimension. On these two dimensions, <code>Cereal</code> and
<code>Toasted</code> are negatively correlated with <code>Malt</code>
and <code>Hop</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="inference-plots-and-results">Inference plots and results<a class="anchor" aria-label="anchor" href="#inference-plots-and-results"></a>
</h2>
<p>The inference analysis of PCA (performed by
<code>OTAplotInference</code>) includes bootstrap test of the proportion
of variance explained, permutation tests of the eigenvalues, the
bootstrap tests of the column factor scores <span class="math inline">\(\mathbf{G}\)</span> (i.e., the right singular
vectors scaled to have the variance of each dimension equals the
corresponding singular value; <span class="math inline">\(\mathbf{G} =
\mathbf{Q}\boldsymbol{\Delta}\)</span> with <span class="math inline">\(\mathbf{X =
P}\boldsymbol{\Delta}\mathbf{Q}^\top\)</span>). These column factor
scores are stored as <code>fj</code> in the output of
<code>epPCA</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plot.pca.inference</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph4epPCA.html">OTAplotInference</a></span><span class="op">(</span></span>
<span>    resPCA <span class="op">=</span> <span class="va">res.pca</span>,</span>
<span>    data <span class="op">=</span> <span class="va">beers</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="bootstrap-and-permutation-tests-on-the-eigenvalues">Bootstrap and permutation tests on the eigenvalues<a class="anchor" aria-label="anchor" href="#bootstrap-and-permutation-tests-on-the-eigenvalues"></a>
</h3>
<p>The inference scree plot illustrates the 95% bootstrap confidence
intervals of the percentage of variance explained by each eigenvalue. If
an interval includes 0, the component explains reliably larger than 0%
of the variance.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plot.pca.inference</span><span class="op">$</span><span class="va">results.graphs</span><span class="op">$</span><span class="va">scree</span></span></code></pre></div>
<p><img src="B1_PCAonBeers_files/figure-html/scree%20inference-1.svg" width="672"></p>
<p>The bootstrap test identifies one significant dimension explains the
variance reliably larger than 0%. The permutation test identifies one
significant dimension with an eigenvalue significantly larger than
0.</p>
</div>
<div class="section level3">
<h3 id="bootstrap-test-on-the-column-factor-scores">Bootstrap test on the column factor scores<a class="anchor" aria-label="anchor" href="#bootstrap-test-on-the-column-factor-scores"></a>
</h3>
<p>The bar plot illustrates the <em>bootstrap ratios</em> which equals
<span class="math display">\[\frac{M_{g_{j}boot}}{SD_{g_{j}boot}},\]</span>
where <span class="math inline">\(M_{g_{j}boot}\)</span> is the mean of
the bootstrapped sample of the <em>j</em>th column factor score and
<span class="math inline">\(SD_{g_{j}boot}\)</span> is the bootstrapped
standard deviation of the factor score. A bootstrap ratio is equivalent
to a <em>t</em>-statistics for the column factor score with the <span class="math inline">\(\mathrm{H}_0: g_j = 0\)</span>. The threshold is
set to 2 to approximate the critical <em>t</em>-value of 1.96 at <span class="math inline">\(\alpha\)</span> = .05.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plot.pca.inference</span><span class="op">$</span><span class="va">results.graphs</span><span class="op">$</span><span class="va">BR1</span></span></code></pre></div>
<p><img src="B1_PCAonBeers_files/figure-html/bootstrap%20ratios%201-1.svg" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.plot.pca.inference</span><span class="op">$</span><span class="va">results.graphs</span><span class="op">$</span><span class="va">BR2</span></span></code></pre></div>
<p><img src="B1_PCAonBeers_files/figure-html/bootstrap%20ratios%202-1.svg" width="672"></p>
<p>The results show no significant factor scores for both dimensions
that is reliably different from 0.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Hervé Abdi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
