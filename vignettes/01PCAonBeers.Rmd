---
title: "PCA on the Beer Data"
author: "Vincent Guillemot, HervÃ© Abdi, Ju-Chi Yu & Soudeh Ardestani Khoubrouy"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{PCA on the Beer Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo = TRUE, 
  dev = "svg",
  fig.ext = "svg", 
  fig.width = 7, 
  fig.height = 7
)
library(dplyr)
library(ExPosition)
library(knitr)
library(kableExtra)
library(ggplot2)
library(InPosition)
```

## Load the data and the packages


```{r beers, warning=FALSE, message=FALSE}
library(R4SPISE2022)
data("sixBeers12Descriptors10Judges", package = "data4PCCAR")
beers <- sixBeers12Descriptors10Judges$ratingsIntensity
beerColors <- sixBeers12Descriptors10Judges$color4Products
descColors <- sixBeers12Descriptors10Judges$color4Descriptors
```

 * `beers`: the ratings;
 * `beerColors`: colors for the beers;
 * `descColors`: colors for the descriptors.

## Do the PCA

```{r epPCA}
res.pca <- epPCA(beers, 
                 center = TRUE, # Center the data
                 scale = FALSE, # **Do not** scale the variables
                 graphs = FALSE) 
```

## Plot the results

```{r plotPCA, fig.show = 'hide'}
res.plot.pca <- OTAplot(
    resPCA = res.pca,
    data = beers
    )
```

 * `results.stats`: useful statistics after performing PCA, among which one can find the factor scores, loadings, eigenvalues, and contributions;
 * `results.graphs`: all the PCA graphs (heatmaps, screeplot, factor map, correlation circles, loading maps etc.) 
 * `description.graphs`: the titles of these graphs, used as titles in the PPTX file.
 
## Some graphs

```{r scree}
res.plot.pca$results.graphs$scree
```

```{r factor scores}
res.plot.pca$results.graphs$factorScoresI12
```

```{r correlation circle}
res.plot.pca$results.graphs$cosineCircleArrowJ12
```

## Inference plots and results

```{r plotPCAinference, echo = FALSE, fig.show = 'hide', warning = FALSE, message = FALSE}
res.plot.pca.inference <- OTAplotInference(
    resPCA = res.pca,
    data = beers
    ) %>% suppressMessages()
```


```{r scree inference, warning = FALSE, message = FALSE}
res.plot.pca.inference$results.graphs$scree
```

```{r bootstrap ratios 1}
res.plot.pca.inference$results.graphs$BR1
```

```{r bootstrap ratios 2}
res.plot.pca.inference$results.graphs$BR2
```

