---
title: "PCA on the Chewing-gum Data"
author: "Vincent Guillemot, HervÃ© Abdi, Ju-Chi Yu & Soudeh Ardestani Khoubrouy"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{PCA on the Chewing-gum Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo = TRUE, 
  dev = "svg",
  fig.ext = "svg", 
  fig.width = 7, 
  fig.height = 7
)
library(dplyr)
library(ExPosition)
library(knitr)
library(kableExtra)
library(ggplot2)
```

## Load the data and the packages


```{r chgu, warning=FALSE, message=FALSE}
library(R4SPISE2022)
data("sixteenGums4Descriptors", package = "data4PCCAR")
chgu <- sixteenGums4Descriptors$ratingsIntensity
chguColors <- sixteenGums4Descriptors$color4Products
descColors <- sixteenGums4Descriptors$color4Descriptors
```

 * `chgu`: the intensities;
 * `chguColors`: colors for the chewing-gums;
 * `descColors`: colors for the descriptors.

## Do the PCA

```{r epPCA}
res.pca <- epPCA(chgu, 
                 center = TRUE, # Center the data
                 scale = "ss1", # Scale the variables
                 graphs = FALSE) 
```

## Plot the results

```{r plotPCA, fig.show = 'hide'}
res.plot.pca <- OTAplot(
    resPCA = res.pca,
    data = chgu
    )
```

 * `results.stats`: useful statistics after performing PCA, among which one can find the factor scores, loadings, eigenvalues, and contributions;
 * `results.graphs`: all the PCA graphs (heatmaps, screeplot, factor map, correlation circles, loading maps etc.) 
 * `description.graphs`: the titles of these graphs, used as titles in the PPTX file.
 
## Some graphs

```{r scree}
res.plot.pca$results.graphs$scree
```

```{r factor scores}
res.plot.pca$results.graphs$factorScoresI12
```

```{r correlation circle}
res.plot.pca$results.graphs$cosineCircleArrowJ12
```

